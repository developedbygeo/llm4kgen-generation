UNWIND $rows AS row MERGE (artist:Artist {name: row.name}) ON CREATE SET artist.DisplayName = row.DisplayName, artist.name = row.name, artist.created = row.created, artist.updated = row.updated ON MATCH SET artist.DisplayName = row.DisplayName, artist.name = row.name, artist.updated = row.updated;
UNWIND $rows AS row with row WHERE row.Nationality IS NOT NULL MERGE (nationality:Nationality {Nationality: row.Nationality}) ON CREATE SET nationality.Nationality = row.Nationality MERGE (artist:Artist {name: row.name}) MERGE (artist)-[:HAS_NATIONALITY]->(nationality);
UNWIND $rows AS row with row WHERE row.BeginDate IS NOT NULL MERGE (beginDate:BeginDate {BeginDate: row.BeginDate}) ON CREATE SET beginDate.BeginDate = row.BeginDate MERGE (artist:Artist {name: row.name}) MERGE (artist)-[:HAS_BEGIN_DATE]->(beginDate);
UNWIND $rows AS row with row WHERE row['Wiki QID'] IS NOT NULL MERGE (wikiQID:WikiQID {WikiQID: row['Wiki QID']}) ON CREATE SET wikiQID.WikiQID = row['Wiki QID'] MERGE (artist:Artist {name: row.name}) MERGE (artist)-[:HAS_WIKI_QID]->(wikiQID);
UNWIND $rows AS row with row WHERE row.ULAN IS NOT NULL MERGE (ulan:ULAN {ULAN: row.ULAN}) ON CREATE SET ulan.ULAN = row.ULAN MERGE (artist:Artist {name: row.name}) MERGE (artist)-[:HAS_ULAN]->(ulan);
UNWIND $rows AS row with row WHERE row.Gender IS NOT NULL MERGE (gender:Gender {Gender: row.Gender}) ON CREATE SET gender.Gender = row.Gender MERGE (artist:Artist {name: row.name}) MERGE (artist)-[:HAS_GENDER]->(gender);
UNWIND $rows AS row with row WHERE row.EndDate IS NOT NULL MERGE (endDate:EndDate {EndDate: row.EndDate}) ON CREATE SET endDate.EndDate = row.EndDate MERGE (artist:Artist {name: row.name}) MERGE (artist)-[:HAS_END_DATE]->(endDate);
UNWIND $rows AS row with row WHERE row.ArtistBio IS NOT NULL MERGE (artistBio:ArtistBio {ArtistBio: row.ArtistBio}) ON CREATE SET artistBio.ArtistBio = row.ArtistBio MERGE (artist:Artist {name: row.name}) MERGE (artist)-[:HAS_ARTIST_BIO]->(artistBio);
